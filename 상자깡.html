<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>GGST ìƒì ì‹œë®¬ë ˆì´í„°</title>
<style>
body {
  font-family: Arial, sans-serif;
  background: #111;
  color: #eee;
  text-align: center;
}
button {
  font-size: 18px;
  padding: 10px 25px;
  margin: 10px;
  cursor: pointer;
}
button:disabled {
  background: #333;
  color: #777;
  cursor: not-allowed;
}
.box {
  margin-top: 20px;
  border-top: 1px solid #444;
  padding-top: 15px;
}
.log {
  margin: 20px auto;
  width: 80%;
  height: 180px;
  overflow-y: auto;
  border: 1px solid #333;
  padding: 10px;
  text-align: left;
  font-size: 14px;
}
.success {
  color: #4cff4c;
  font-weight: bold;
}
</style>
</head>

<body>

<h1>GGST ìƒì ì‹œë®¬ë ˆì´í„°</h1>

<button id="openBtn" onclick="openBox()">ğŸ“¦ ìƒì ì—´ê¸°</button>
<button id="resetBtn" onclick="resetSim()" disabled>ğŸ”„ ì¬ë„ì „</button>

<div class="box">
  <p>ìƒì ìˆ˜: <b><span id="boxes">0</span></b></p>
  <p>ì¹´ë“œ ìˆ˜: <b><span id="cards">0</span></b></p>
  <p>í† í°: <b><span id="tokens">0</span></b> / 555</p>
  <p>ì‚¬ìš© ê¸ˆì•¡: <b><span id="money">0</span></b> ì›</p>
</div>

<div class="log" id="log">ëŒ€ê¸° ì¤‘...</div>

<script>
const table = [
  [100, 0.01],
  [50,  0.03],
  [30,  0.05],
  [20,  0.05],
  [10,  0.10],
  [5,   0.20],
  [3,   0.35],
  [1,   0.21],
];

let boxes = 0;
let cards = 0;
let tokens = 0;
let money = 0;
let bonusGiven = false;
let finished = false;

function rollToken() {
  let r = Math.random();
  let acc = 0;
  for (let i = 0; i < table.length; i++) {
    acc += table[i][1];
    if (r <= acc) return table[i][0];
  }
  return 1;
}

function openBox() {
  if (finished) return;

  boxes++;
  cards++;

  const got = rollToken();
  tokens += got;

  let logText = `ğŸ“¦ ${boxes}ë²ˆì§¸ ìƒì â†’ í† í° ${got}ê°œ`;

  if (cards === 50 && !bonusGiven) {
    tokens += 100;
    bonusGiven = true;
    logText += ` ğŸ”¥ ì¹´ë“œ 50ì¥ ë³´ë„ˆìŠ¤ +100`;
  }

  if (boxes % 10 === 0) {
    money += 10900;
    logText += ` ğŸ’¸ 10ìƒì ê²°ì œ`;
  }

  prependLog(logText);
  updateUI();

  if (tokens >= 555) {
    finished = true;
    document.getElementById("openBtn").disabled = true;
    document.getElementById("resetBtn").disabled = false;

    prependLog(
      `<span class="success">ğŸ‰ ëª©í‘œ ë‹¬ì„±!</span><br>
       ì´ ìƒì: ${boxes}<br>
       ì´ ì‚¬ìš© ê¸ˆì•¡: ${money}ì›`
    );
  }
}

function prependLog(text) {
  const log = document.getElementById("log");
  log.innerHTML = text + "<br>" + log.innerHTML;
}

function updateUI() {
  document.getElementById("boxes").textContent = boxes;
  document.getElementById("cards").textContent = cards;
  document.getElementById("tokens").textContent = tokens;
  document.getElementById("money").textContent = money;
}

function resetSim() {
  boxes = 0;
  cards = 0;
  tokens = 0;
  money = 0;
  bonusGiven = false;
  finished = false;

  document.getElementById("openBtn").disabled = false;
  document.getElementById("resetBtn").disabled = true;
  document.getElementById("log").innerHTML = "ëŒ€ê¸° ì¤‘...";

  updateUI();
}
</script>

</body>
</html>
